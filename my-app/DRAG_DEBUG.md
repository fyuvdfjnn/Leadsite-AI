# æ‹–æ‹½åŠŸèƒ½è°ƒè¯•æŒ‡å—

## ğŸ¯ ä½¿ç”¨æ­¥éª¤

1. **å¯ç”¨è‡ªç”±æ‹–æ‹½æ¨¡å¼**
   - ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„ **"Free Drag"** æŒ‰é’®ï¼ˆç´«è‰²æŒ‰é’®ï¼‰
   - æŒ‰é’®ä¼šå˜ä¸ºé«˜äº®çŠ¶æ€

2. **é€‰ä¸­å…ƒç´ **
   - å°†é¼ æ ‡æ‚¬åœåœ¨ç½‘é¡µå…ƒç´ ä¸Šï¼Œä¼šçœ‹åˆ°è“è‰²é«˜äº®è¾¹æ¡†
   - ç‚¹å‡»å…ƒç´ å³å¯é€‰ä¸­ï¼ˆä¼šå‡ºç°8ä¸ªæ‹–æ‹½æ‰‹æŸ„ï¼‰

3. **æ‹–æ‹½å…ƒç´ **
   - ç‚¹å‡»å¹¶æ‹–åŠ¨å…ƒç´ ä¸­å¿ƒåŒºåŸŸï¼ˆä¼šæ˜¾ç¤º"æ‹–åŠ¨ç§»åŠ¨"æç¤ºï¼‰
   - æˆ–è€…æ‹–åŠ¨8ä¸ªè§’è½/è¾¹ç¼˜çš„æ‰‹æŸ„æ¥è°ƒæ•´å¤§å°
   - æˆ–è€…ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„"ç§»åŠ¨"æŒ‰é’®åæ‹–åŠ¨

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šç‚¹å‡»å…ƒç´ æ²¡æœ‰ååº”

**æ£€æŸ¥æ¸…å•ï¼š**
- âœ… ç¡®è®¤ "Free Drag" æŒ‰é’®å·²å¯ç”¨ï¼ˆæŒ‰é’®åº”è¯¥æ˜¯ç´«è‰²é«˜äº®çŠ¶æ€ï¼‰
- âœ… ç¡®è®¤ä¸æ˜¯ç‚¹å‡»åœ¨å·¥å…·æ æˆ–è¦†ç›–å±‚ä¸Š
- âœ… æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ `[FreeDrag] Selected:` æ—¥å¿—
- âœ… ç¡®è®¤é¡µé¢å·²ç»ç”Ÿæˆäº†å†…å®¹ï¼ˆä¸æ˜¯ç©ºçŠ¶æ€ï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å…ƒç´ 
document.querySelectorAll('[data-component]').length
// åº”è¯¥ > 0
```

### é—®é¢˜2ï¼šé€‰ä¸­äº†ä½†æ‹–ä¸åŠ¨

**æ£€æŸ¥æ¸…å•ï¼š**
- âœ… ç¡®è®¤é¼ æ ‡å…‰æ ‡å˜æˆäº† "grabbing" æˆ– "move"
- âœ… ç¡®è®¤å…ƒç´ è¢«é€‰ä¸­ï¼ˆæœ‰è“è‰²è¾¹æ¡†å’Œ8ä¸ªæ‰‹æŸ„ï¼‰
- âœ… æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰ `[Drag] Start drag` æ—¥å¿—
- âœ… ç¡®è®¤ä¸æ˜¯ç‚¹å‡»åœ¨å·¥å…·æ æŒ‰é’®ä¸Šï¼Œè€Œæ˜¯ç‚¹å‡»åœ¨å…ƒç´ ä¸­å¿ƒåŒºåŸŸ

**è§£å†³æ–¹æ¡ˆï¼š**
- å°è¯•ç‚¹å‡»å…ƒç´ ä¸­å¿ƒåŒºåŸŸï¼ˆä¸æ˜¯è¾¹æ¡†ï¼‰
- å°è¯•æ‹–åŠ¨8ä¸ªè§’è½çš„æ‰‹æŸ„ï¼ˆç”¨äºè°ƒæ•´å¤§å°ï¼‰
- ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„"ç§»åŠ¨"æŒ‰é’®åå†æ‹–åŠ¨

### é—®é¢˜3ï¼šæ‹–åŠ¨äº†ä½†å…ƒç´ ä½ç½®æ²¡å˜åŒ–

**æ£€æŸ¥æ¸…å•ï¼š**
- âœ… æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰ `[Drag] Updated:` æ—¥å¿—
- âœ… æ£€æŸ¥å…ƒç´ çš„ `style` å±æ€§æ˜¯å¦æ›´æ–°äº†ï¼ˆå³é”®å…ƒç´  â†’ æ£€æŸ¥ â†’ æŸ¥çœ‹ Stylesï¼‰
- âœ… ç¡®è®¤å…ƒç´ ä¸æ˜¯è¢« CSS è¦†ç›–äº†å®šä½

**è§£å†³æ–¹æ¡ˆï¼š**
- å…ƒç´ åº”è¯¥å˜æˆ `position: fixed` å¹¶è®¾ç½®äº† `left` å’Œ `top`
- å¦‚æœæ‹–æ‹½åå…ƒç´ ä½ç½®ä¸å¯¹ï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥çˆ¶å…ƒç´ çš„å®šä½

### é—®é¢˜4ï¼šæ‹–æ‹½æ—¶é€‰ä¸­æ¡†æ¶ˆå¤±äº†

**è¿™æ˜¯æ­£å¸¸çš„ï¼** æ‹–æ‹½æ—¶é€‰ä¸­æ¡†ä¼šæš‚æ—¶æ¶ˆå¤±ï¼Œæ‹–æ‹½ç»“æŸåä¼šæ¢å¤ã€‚

### é—®é¢˜5ï¼šå…ƒç´ æ‹–æ‹½åè·³å›åŸä½

**åŸå› ï¼š** React é‡æ–°æ¸²æŸ“å¯¼è‡´æ ·å¼è¢«é‡ç½®

**è§£å†³æ–¹æ¡ˆï¼š** éœ€è¦åœ¨ `onElementUpdate` å›è°ƒä¸­ä¿å­˜ä½ç½®åˆ°çŠ¶æ€ï¼š

```typescript
onElementUpdate={(element, changes) => {
  // ä¿å­˜åˆ°çŠ¶æ€æˆ–æ•°æ®åº“
  setElementStyles(element.dataset.id, changes)
}}
```

## ğŸ”§ è°ƒè¯•ä»£ç 

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œä»¥ä¸‹ä»£ç æ¥æ£€æŸ¥ï¼š

```javascript
// 1. æ£€æŸ¥æ˜¯å¦æœ‰å¯æ‹–æ‹½çš„å…ƒç´ 
console.log('å¯æ‹–æ‹½å…ƒç´ :', document.querySelectorAll('[data-component], section, header, div[class]'))

// 2. æ£€æŸ¥ Free Drag æ˜¯å¦å¯ç”¨
console.log('Free Drag çŠ¶æ€:', document.querySelector('[data-visual-overlay]') !== null)

// 3. æ£€æŸ¥æ˜¯å¦æœ‰é€‰ä¸­å…ƒç´ 
console.log('é€‰ä¸­å…ƒç´ :', document.querySelector('.border-blue-600'))

// 4. æ‰‹åŠ¨æµ‹è¯•å…ƒç´ æ£€æµ‹
const testElement = document.querySelector('section')
if (testElement) {
  console.log('æµ‹è¯•å…ƒç´ :', {
    element: testElement,
    rect: testElement.getBoundingClientRect(),
    position: window.getComputedStyle(testElement).position
  })
}
```

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ‹–æ‹½å®ç°åŸç†

1. **å…ƒç´ æ£€æµ‹** - ä½¿ç”¨ `elementFromPoint()` å’Œ `detectElement()` 
2. **é«˜äº®æ˜¾ç¤º** - ä½¿ç”¨ Portal æ¸²æŸ“è¦†ç›–å±‚
3. **æ‹–æ‹½å¤„ç†** - `mousedown` â†’ `mousemove` â†’ `mouseup` äº‹ä»¶é“¾
4. **ä½ç½®æ›´æ–°** - åŠ¨æ€è®¾ç½® `element.style.position = 'fixed'` å’Œ `left/top`

### å…³é”®æ–‡ä»¶

- `components/visual-select-overlay.tsx` - æ‹–æ‹½æ ¸å¿ƒç»„ä»¶
- `lib/element-detector.ts` - å…ƒç´ æ£€æµ‹é€»è¾‘
- `components/visual-editor.tsx` - ä¸»ç¼–è¾‘å™¨é›†æˆ

## ğŸ’¡ æç¤º

- æ‹–æ‹½åŠŸèƒ½ç›®å‰åªé€‚ç”¨äº **å·²ç”Ÿæˆçš„é¡µé¢å†…å®¹**
- ç¡®ä¿åœ¨å¯ç”¨ Free Drag åï¼Œå…¶ä»–ç¼–è¾‘å™¨åŠŸèƒ½ï¼ˆå¦‚ Selectï¼‰å·²å…³é—­
- æ‹–æ‹½åçš„ä½ç½®æ˜¯ä¸´æ—¶çš„ï¼Œéœ€è¦ä¿å­˜åˆ°çŠ¶æ€æ‰èƒ½æŒä¹…åŒ–









